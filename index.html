<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet Map</title>

    <!-- leaflet css -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>

    <style>
    
    .item3 { grid-area: footer }

    .grid-container {
            display: grid;
            grid-template-areas:
            'menu map main main right right'
            'menu footer footer footer footer footer';
            gap: 10px;
            background-color: #0ab0d9;
            padding: 10px;
            overflow: hidden;
            position: relative;/*takes whole lenght of screen*/
            width: 100%;/*does nothing?*/
            height: 100%;/*does nothing?*/
    }

    .grid-container > div {
    background-color: rgba(255, 255, 255, 0.8);
    text-align: center;
    padding: 20px 0;
    font-size: 30px;

    }

        body {
            margin: 30px;
            padding: 0;
            font-family: Montreal, Helvetica, sans-serif;
            color: black;
            font-size: 1.5em;
            background-color: rgb(253, 236, 222);
            overflow: auto;  /*scrolling*/
            position: relative;/*takes whole lenght of screen*/       
        }

        #text-box {
            width: 30%;
            padding: 20px;
            background-color: #f2f2f2;
        }
        
        #title-container {
            width: 70%;
            text-align: center;
            border: 2px solid black; 
        }

        #title {
            width: 100%;
            height: 2vh;
            color: #0ab0d9;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 1.7em;
            font-weight: 600;            
            margin-bottom: 34px;
            background-color: #fdc79b;
        }

        #subtitle {
            color: #3d454f;
            font-family: Helvetica, sans-serif;
            font-size: 1em;
            margin-top: 40px; 
        }

        #second-subtitle {
            color: #3d454f;
            font-family: Helvetica, sans-serif;
            font-size: 0.8em;
            margin-top: 7px;
            margin-bottom: 20px; 
        }
        #map { 
            margin-top: 10px;
            width: 500%;
            height: 100vh; 
            border-style: solid;
            border-width: 3px;
            border-color: rgb(137, 43, 43);
            
        }

    </style>

</head>

<body>
    <div id="title">Where do we send our products?</div>
    <div id="subtitle">Number of orders dispatched to UK Districts or Irish counties</div>
    <div id="second-subtitle">Number of orders per product per year</div>
    
<div class="grid-container">
  
  <div class="item3">Footer</div>
  <div class="item5">Menu</div>
    <!-- div element which holds the map -->
    <div id="map"></div>
</body>

</html>

<!-- leaflet js -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<!-- turf.js from CDN -->
<script src="https://unpkg.com/@turf/turf@latest"></script>

<!-- import js files for each district-->
<!-- Ireland -->
<script src="./data/1.Donegal.js"></script>
<script src="./data/2.Limerick.js"></script>
<script src="./data/3.Kildare.js"></script>
<script src="./data/4.Waterford.js"></script>
<script src="./data/5.Dublin.js"></script>
<script src="./data/6.Westmeath.js"></script>
<script src="./data/7.Monaghan.js"></script>
<script src="./data/8.Wicklow.js"></script>
<script src="./data/9.Cork.js"></script>
<script src="./data/10.Kerry.js"></script>
<script src="./data/11.Roscommon.js"></script>
<script src="./data/12.Wexford.js"></script>
<script src="./data/13.Longford.js"></script>
<script src="./data/14.Meath.js"></script>
<script src="./data/15.Cavan.js"></script>
<script src="./data/16.Carlow.js"></script>
<script src="./data/17.Mayo.js"></script>
<script src="./data/18.Louth.js"></script>
<script src="./data/19.Sligo.js"></script>
<script src="./data/20.Leitrim.js"></script>
<script src="./data/21.Kilkenny.js"></script>
<script src="./data/22.Offaly.js"></script>
<script src="./data/23.Laois.js"></script>
<script src="./data/24.Galway.js"></script>
<script src="./data/25.Tipperary.js"></script>
<script src="./data/26.Clare.js"></script>
<!-- UK -->
<script src="./data/Aberdeen City.js"></script>
<script src="./data/Aberdeenshire.js"></script>
<script src="./data/Adur.js"></script>
<script src="./data/Allerdale.js"></script>
<script src="./data/Amber Valley.js"></script>
<script src="./data/Angus.js"></script>
<script src="./data/Antrim and Newtownabbey.js"></script>
<script src="./data/Ards and North Down.js"></script>
<script src="./data/Argyll and Bute.js"></script>
<script src="./data/Armagh City, Banbridge and Craigavon.js"></script>
<script src="./data/Arun.js"></script>
<script src="./data/Ashfield.js"></script>
<script src="./data/Ashford.js"></script>
<script src="./data/Babergh.js"></script>
<script src="./data/Barking and Dagenham.js"></script>
<script src="./data/Barnet.js"></script>
<script src="./data/Barnsley.js"></script>
<script src="./data/Barrow-in-Furness.js"></script>
<script src="./data/Basildon.js"></script>
<script src="./data/Basingstoke and Deane.js"></script>
<script src="./data/Bassetlaw.js"></script>
<script src="./data/Bath and North East Somerset.js"></script>
<script src="./data/Bedford.js"></script>
<script src="./data/Belfast.js"></script>
<script src="./data/Bexley.js"></script>
<script src="./data/Birmingham.js"></script>
<script src="./data/Blaby.js"></script>
<script src="./data/Blackburn with Darwen.js"></script>
<script src="./data/Blackpool.js"></script>
<script src="./data/Blaenau Gwent.js"></script>
<script src="./data/Bolsover.js"></script>
<script src="./data/Bolton.js"></script>
<script src="./data/Boston.js"></script>
<script src="./data/Bournemouth, Christchurch and Poole.js"></script>
<script src="./data/Bracknell Forest.js"></script>
<script src="./data/Bradford.js"></script>
<script src="./data/Braintree.js"></script>
<script src="./data/Breckland.js"></script>
<script src="./data/Brent.js"></script>
<script src="./data/Brentwood.js"></script>
<script src="./data/Bridgend.js"></script>
<script src="./data/Brighton and Hove.js"></script>
<script src="./data/Bristol, City of.js"></script>
<script src="./data/Broadland.js"></script>
<script src="./data/Bromley.js"></script>
<script src="./data/Bromsgrove.js"></script>
<script src="./data/Broxbourne.js"></script>
<script src="./data/Broxtowe.js"></script>
<script src="./data/Buckinghamshire.js"></script>
<script src="./data/Burnley.js"></script>
<script src="./data/Bury.js"></script>
<script src="./data/Caerphilly.js"></script>
<script src="./data/Calderdale.js"></script>
<script src="./data/Cambridge.js"></script>
<script src="./data/Camden.js"></script>
<script src="./data/Cannock Chase.js"></script>
<script src="./data/Canterbury.js"></script>
<script src="./data/Cardiff.js"></script>
<script src="./data/Carlisle.js"></script>
<script src="./data/Carmarthenshire.js"></script>
<script src="./data/Castle Point.js"></script>
<script src="./data/Causeway Coast and Glens.js"></script>
<script src="./data/Central Bedfordshire.js"></script>
<script src="./data/Ceredigion.js"></script>
<script src="./data/Charnwood.js"></script>
<script src="./data/Chelmsford.js"></script>
<script src="./data/Cheltenham.js"></script>
<script src="./data/Cherwell.js"></script>
<script src="./data/Cheshire East.js"></script>
<script src="./data/Cheshire West and Chester.js"></script>
<script src="./data/Chesterfield.js"></script>
<script src="./data/Chichester.js"></script>
<script src="./data/Chorley.js"></script>
<script src="./data/City of Edinburgh.js"></script>
<script src="./data/City of London.js"></script>
<script src="./data/Clackmannanshire.js"></script>
<script src="./data/Colchester.js"></script>
<script src="./data/Conwy.js"></script>
<script src="./data/Copeland.js"></script>
<script src="./data/Cornwall.js"></script>
<script src="./data/Cotswold.js"></script>
<script src="./data/County Durham.js"></script>
<script src="./data/Coventry.js"></script>
<script src="./data/Craven.js"></script>
<script src="./data/Crawley.js"></script>
<script src="./data/Croydon.js"></script>
<script src="./data/Dacorum.js"></script>
<script src="./data/Darlington.js"></script>
<script src="./data/Dartford.js"></script>
<script src="./data/Denbighshire.js"></script>
<script src="./data/Derby.js"></script>
<script src="./data/Derbyshire Dales.js"></script>
<script src="./data/Derry City and Strabane.js"></script>
<script src="./data/Doncaster.js"></script>
<script src="./data/Dorset.js"></script>
<script src="./data/Dover.js"></script>
<script src="./data/Dudley.js"></script>
<script src="./data/Dumfries and Galloway.js"></script>
<script src="./data/Dundee City.js"></script>
<script src="./data/Ealing.js"></script>
<script src="./data/East Ayrshire.js"></script>
<script src="./data/East Cambridgeshire.js"></script>
<script src="./data/East Devon.js"></script>
<script src="./data/East Dunbartonshire.js"></script>
<script src="./data/East Hampshire.js"></script>
<script src="./data/East Hertfordshire.js"></script>
<script src="./data/East Lindsey.js"></script>
<script src="./data/East Lothian.js"></script>
<script src="./data/East Renfrewshire.js"></script>
<script src="./data/East Riding of Yorkshire.js"></script>
<script src="./data/East Staffordshire.js"></script>
<script src="./data/East Suffolk.js"></script>
<script src="./data/Eastbourne.js"></script>
<script src="./data/Eastleigh.js"></script>
<script src="./data/Eden.js"></script>
<script src="./data/Elmbridge.js"></script>
<script src="./data/Enfield.js"></script>
<script src="./data/Epping Forest.js"></script>
<script src="./data/Epsom and Ewell.js"></script>
<script src="./data/Erewash.js"></script>
<script src="./data/Exeter.js"></script>
<script src="./data/Falkirk.js"></script>
<script src="./data/Fareham.js"></script>
<script src="./data/Fenland.js"></script>
<script src="./data/Fermanagh and Omagh.js"></script>
<script src="./data/Fife.js"></script>
<script src="./data/Flintshire.js"></script>
<script src="./data/Folkestone and Hythe.js"></script>
<script src="./data/Forest of Dean.js"></script>
<script src="./data/Fylde.js"></script>
<script src="./data/Gateshead.js"></script>
<script src="./data/Gedling.js"></script>
<script src="./data/Glasgow City.js"></script>
<script src="./data/Gloucester.js"></script>
<script src="./data/Gosport.js"></script>
<script src="./data/Gravesham.js"></script>
<script src="./data/Great Yarmouth.js"></script>
<script src="./data/Greenwich.js"></script>
<script src="./data/Guildford.js"></script>
<script src="./data/Gwynedd.js"></script>
<script src="./data/Hackney.js"></script>
<script src="./data/Halton.js"></script>
<script src="./data/Hambleton.js"></script>
<script src="./data/Hammersmith and Fulham.js"></script>
<script src="./data/Harborough.js"></script>
<script src="./data/Haringey.js"></script>
<script src="./data/Harlow.js"></script>
<script src="./data/Harrogate.js"></script>
<script src="./data/Harrow.js"></script>
<script src="./data/Hart.js"></script>
<script src="./data/Hartlepool.js"></script>
<script src="./data/Hastings.js"></script>
<script src="./data/Havant.js"></script>
<script src="./data/Havering.js"></script>
<script src="./data/Herefordshire, County of.js"></script>
<script src="./data/Hertsmere.js"></script>
<script src="./data/High Peak.js"></script>
<script src="./data/Highland.js"></script>
<script src="./data/Hillingdon.js"></script>
<script src="./data/Hinckley and Bosworth.js"></script>
<script src="./data/Horsham.js"></script>
<script src="./data/Hounslow.js"></script>
<script src="./data/Huntingdonshire.js"></script>
<script src="./data/Hyndburn.js"></script>
<script src="./data/Inverclyde.js"></script>
<script src="./data/Ipswich.js"></script>
<script src="./data/Isle of Anglesey.js"></script>
<script src="./data/Isle of Wight.js"></script>
<script src="./data/Isles of Scilly.js"></script>
<script src="./data/Islington.js"></script>
<script src="./data/Kensington and Chelsea.js"></script>
<script src="./data/King's Lynn and West Norfolk.js"></script>
<script src="./data/Kingston upon Hull, City of.js"></script>
<script src="./data/Kingston upon Thames.js"></script>
<script src="./data/Kirklees.js"></script>
<script src="./data/Knowsley.js"></script>
<script src="./data/Lambeth.js"></script>
<script src="./data/Lancaster.js"></script>
<script src="./data/Leeds.js"></script>
<script src="./data/Leicester.js"></script>
<script src="./data/Lewes.js"></script>
<script src="./data/Lewisham.js"></script>
<script src="./data/Lichfield.js"></script>
<script src="./data/Lincoln.js"></script>
<script src="./data/Lisburn and Castlereagh.js"></script>
<script src="./data/Liverpool.js"></script>
<script src="./data/Luton.js"></script>
<script src="./data/Maidstone.js"></script>
<script src="./data/Maldon.js"></script>
<script src="./data/Malvern Hills.js"></script>
<script src="./data/Manchester.js"></script>
<script src="./data/Mansfield.js"></script>
<script src="./data/Medway.js"></script>
<script src="./data/Melton.js"></script>
<script src="./data/Mendip.js"></script>
<script src="./data/Merthyr Tydfil.js"></script>
<script src="./data/Merton.js"></script>
<script src="./data/Mid Devon.js"></script>
<script src="./data/Mid Suffolk.js"></script>
<script src="./data/Mid Sussex.js"></script>
<script src="./data/Mid Ulster.js"></script>
<script src="./data/Mid and East Antrim.js"></script>
<script src="./data/Middlesbrough.js"></script>
<script src="./data/Midlothian.js"></script>
<script src="./data/Milton Keynes.js"></script>
<script src="./data/Mole Valley.js"></script>
<script src="./data/Monmouthshire.js"></script>
<script src="./data/Moray.js"></script>
<script src="./data/Na h-Eileanan Siar.js"></script>
<script src="./data/Neath Port Talbot.js"></script>
<script src="./data/New Forest.js"></script>
<script src="./data/Newark and Sherwood.js"></script>
<script src="./data/Newcastle upon Tyne.js"></script>
<script src="./data/Newcastle-under-Lyme.js"></script>
<script src="./data/Newham.js"></script>
<script src="./data/Newport.js"></script>
<script src="./data/Newry, Mourne and Down.js"></script>
<script src="./data/North Ayrshire.js"></script>
<script src="./data/North Devon.js"></script>
<script src="./data/North East Derbyshire.js"></script>
<script src="./data/North East Lincolnshire.js"></script>
<script src="./data/North Hertfordshire.js"></script>
<script src="./data/North Kesteven.js"></script>
<script src="./data/North Lanarkshire.js"></script>
<script src="./data/North Lincolnshire.js"></script>
<script src="./data/North Norfolk.js"></script>
<script src="./data/North Northamptonshire.js"></script>
<script src="./data/North Somerset.js"></script>
<script src="./data/North Tyneside.js"></script>
<script src="./data/North Warwickshire.js"></script>
<script src="./data/North West Leicestershire.js"></script>
<script src="./data/Northumberland.js"></script>
<script src="./data/Norwich.js"></script>
<script src="./data/Nottingham.js"></script>
<script src="./data/Nuneaton and Bedworth.js"></script>
<script src="./data/Oadby and Wigston.js"></script>
<script src="./data/Oldham.js"></script>
<script src="./data/Orkney Islands.js"></script>
<script src="./data/Oxford.js"></script>
<script src="./data/Pembrokeshire.js"></script>
<script src="./data/Pendle.js"></script>
<script src="./data/Perth and Kinross.js"></script>
<script src="./data/Peterborough.js"></script>
<script src="./data/Plymouth.js"></script>
<script src="./data/Portsmouth.js"></script>
<script src="./data/Powys.js"></script>
<script src="./data/Preston.js"></script>
<script src="./data/Reading.js"></script>
<script src="./data/Redbridge.js"></script>
<script src="./data/Redcar and Cleveland.js"></script>
<script src="./data/Redditch.js"></script>
<script src="./data/Reigate and Banstead.js"></script>
<script src="./data/Renfrewshire.js"></script>
<script src="./data/Rhondda Cynon Taf.js"></script>
<script src="./data/Ribble Valley.js"></script>
<script src="./data/Richmond upon Thames.js"></script>
<script src="./data/Richmondshire.js"></script>
<script src="./data/Rochdale.js"></script>
<script src="./data/Rochford.js"></script>
<script src="./data/Rossendale.js"></script>
<script src="./data/Rother.js"></script>
<script src="./data/Rotherham.js"></script>
<script src="./data/Rugby.js"></script>
<script src="./data/Runnymede.js"></script>
<script src="./data/Rushcliffe.js"></script>
<script src="./data/Rushmoor.js"></script>
<script src="./data/Rutland.js"></script>
<script src="./data/Ryedale.js"></script>
<script src="./data/Salford.js"></script>
<script src="./data/Sandwell.js"></script>
<script src="./data/Scarborough.js"></script>
<script src="./data/Scottish Borders.js"></script>
<script src="./data/Sedgemoor.js"></script>
<script src="./data/Sefton.js"></script>
<script src="./data/Selby.js"></script>
<script src="./data/Sevenoaks.js"></script>
<script src="./data/Sheffield.js"></script>
<script src="./data/Shetland Islands.js"></script>
<script src="./data/Shropshire.js"></script>
<script src="./data/Slough.js"></script>
<script src="./data/Solihull.js"></script>
<script src="./data/Somerset West and Taunton.js"></script>
<script src="./data/South Ayrshire.js"></script>
<script src="./data/South Cambridgeshire.js"></script>
<script src="./data/South Derbyshire.js"></script>
<script src="./data/South Gloucestershire.js"></script>
<script src="./data/South Hams.js"></script>
<script src="./data/South Holland.js"></script>
<script src="./data/South Kesteven.js"></script>
<script src="./data/South Lakeland.js"></script>
<script src="./data/South Lanarkshire.js"></script>
<script src="./data/South Norfolk.js"></script>
<script src="./data/South Oxfordshire.js"></script>
<script src="./data/South Ribble.js"></script>
<script src="./data/South Somerset.js"></script>
<script src="./data/South Staffordshire.js"></script>
<script src="./data/South Tyneside.js"></script>
<script src="./data/Southampton.js"></script>
<script src="./data/Southend-on-Sea.js"></script>
<script src="./data/Southwark.js"></script>
<script src="./data/Spelthorne.js"></script>
<script src="./data/St Albans.js"></script>
<script src="./data/St. Helens.js"></script>
<script src="./data/Stafford.js"></script>
<script src="./data/Staffordshire Moorlands.js"></script>
<script src="./data/Stevenage.js"></script>
<script src="./data/Stirling.js"></script>
<script src="./data/Stockport.js"></script>
<script src="./data/Stockton-on-Tees.js"></script>
<script src="./data/Stoke-on-Trent.js"></script>
<script src="./data/Stratford-on-Avon.js"></script>
<script src="./data/Stroud.js"></script>
<script src="./data/Sunderland.js"></script>
<script src="./data/Surrey Heath.js"></script>
<script src="./data/Sutton.js"></script>
<script src="./data/Swale.js"></script>
<script src="./data/Swansea.js"></script>
<script src="./data/Swindon.js"></script>
<script src="./data/Tameside.js"></script>
<script src="./data/Tamworth.js"></script>
<script src="./data/Tandridge.js"></script>
<script src="./data/Teignbridge.js"></script>
<script src="./data/Telford and Wrekin.js"></script>
<script src="./data/Tendring.js"></script>
<script src="./data/Test Valley.js"></script>
<script src="./data/Tewkesbury.js"></script>
<script src="./data/Thanet.js"></script>
<script src="./data/Three Rivers.js"></script>
<script src="./data/Thurrock.js"></script>
<script src="./data/Tonbridge and Malling.js"></script>
<script src="./data/Torbay.js"></script>
<script src="./data/Torfaen.js"></script>
<script src="./data/Torridge.js"></script>
<script src="./data/Tower Hamlets.js"></script>
<script src="./data/Trafford.js"></script>
<script src="./data/Tunbridge Wells.js"></script>
<script src="./data/Uttlesford.js"></script>
<script src="./data/Vale of Glamorgan.js"></script>
<script src="./data/Vale of White Horse.js"></script>
<script src="./data/Wakefield.js"></script>
<script src="./data/Walsall.js"></script>
<script src="./data/Waltham Forest.js"></script>
<script src="./data/Wandsworth.js"></script>
<script src="./data/Warrington.js"></script>
<script src="./data/Warwick.js"></script>
<script src="./data/Watford.js"></script>
<script src="./data/Waverley.js"></script>
<script src="./data/Wealden.js"></script>
<script src="./data/Welwyn Hatfield.js"></script>
<script src="./data/West Berkshire.js"></script>
<script src="./data/West Devon.js"></script>
<script src="./data/West Dunbartonshire.js"></script>
<script src="./data/West Lancashire.js"></script>
<script src="./data/West Lindsey.js"></script>
<script src="./data/West Lothian.js"></script>
<script src="./data/West Northamptonshire.js"></script>
<script src="./data/West Oxfordshire.js"></script>
<script src="./data/West Suffolk.js"></script>
<script src="./data/Westminster.js"></script>
<script src="./data/Wigan.js"></script>
<script src="./data/Wiltshire.js"></script>
<script src="./data/Winchester.js"></script>
<script src="./data/Windsor and Maidenhead.js"></script>
<script src="./data/Wirral.js"></script>
<script src="./data/Woking.js"></script>
<script src="./data/Wokingham.js"></script>
<script src="./data/Wolverhampton.js"></script>
<script src="./data/Worcester.js"></script>
<script src="./data/Worthing.js"></script>
<script src="./data/Wrexham.js"></script>
<script src="./data/Wychavon.js"></script>
<script src="./data/Wyre Forest.js"></script>
<script src="./data/Wyre.js"></script>
<script src="./data/York.js"></script>



<script>

    /*===========================================================
                        Initialisation
    ===========================================================*/
    
    // initialise the map and set its view to a geographical location (coordinates) and zoom level
    var map = L.map('map').setView([54.217, -4.558], 6);


    /*===========================================================
                            TILE LAYER
    ===========================================================*/

    // add tile layer to map (osm layer)
    var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    })
    osm.addTo(map)

    // osm hot layer
    var osmHOT = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '© OpenStreetMap contributors, Tiles style by Humanitarian OpenStreetMap Team hosted by OpenStreetMap France'
    });

    /* 
    // We can add additional layers to the map
    https://leaflet-extras.github.io/leaflet-providers/preview/
    */


    /*===========================================================
                            MARKER LAYER
    ===========================================================*/

    // Create polygons and popups
    var polygonData = {
        'Donegal': donegalJSON,
        'Limerick': limerickJSON,
        'Kildare': kildareJSON,
        'Waterford': waterfordJSON,
        'Dublin': dublinJSON,
        'Westmeath': westmeathJSON,
        'Monaghan': monaghanJSON,
        'Wicklow': wicklowJSON,
        'Cork': corkJSON,
        'Kerry': kerryJSON,
        'Roscommon': roscommonJSON,
        'Wexford': wexfordJSON,
        'Longford': longfordJSON,
        'Meath': meathJSON,
        'Cavan': cavanJSON,
        'Carlow': carlowJSON,
        'Mayo': mayoJSON,
        'Louth': louthJSON,
        'Sligo': sligoJSON,
        'Leitrim': leitrimJSON,
        'Kilkenny': kilkennyJSON,
        'Offaly': offalyJSON,
        'Laois': laoisJSON,
        'Galway': galwayJSON,
        'Tipperary': tipperaryJSON,
        'Clare': clareJSON,
        'Aberdeen': aberdeencityJSON,
        'Aberdeenshire': aberdeenshireJSON,
        'Adur': adurJSON,
        'Allerdale': allerdaleJSON,
        'Amber Valley': ambervalleyJSON,
        'Angus': angusJSON,
        'Antrim and Newtownabbey': antrimandnewtownabbeyJSON,
        'Ards and North Down': ardsandnorthdownJSON,
        'Argyll and Bute': argyllandbuteJSON,
        'Armagh City, Banbridge and Craigavon': armaghcity_banbridgeandcraigavonJSON,
        'Arun': arunJSON,
        'Ashfield': ashfieldJSON,
        'Ashford': ashfordJSON,
        'Babergh': baberghJSON,
        'Barking and Dagenham': barkinganddagenhamJSON,
        'Barnet': barnetJSON,
        'Barnsley': barnsleyJSON,
        'Barrow-in-Furness': barrow_in_furnessJSON,
        'Basildon': basildonJSON,
        'Basingstoke and Deane': basingstokeanddeaneJSON,
        'Bassetlaw': bassetlawJSON,
        'Bath and North East Somerset': bathandnortheastsomersetJSON,
        'Bedford': bedfordJSON,
        'Belfast': belfastJSON,
        'Bexley': bexleyJSON,
        'Birmingham': birminghamJSON,
        'Blaby': blabyJSON,
        'Blackburn with Darwen': blackburnwithdarwenJSON,
        'Blackpool': blackpoolJSON,
        'Blaenau Gwent': blaenaugwentJSON,
        'Bolsover': bolsoverJSON,
        'Bolton': boltonJSON,
        'Boston': bostonJSON,
        'Bournemouth, Christchurch and Poole': bournemouthchristchurchandpooleJSON,
        'Bracknell Forest': bracknellforestJSON,
        'Bradford': bradfordJSON,
        'Braintree': braintreeJSON,
        'Breckland': brecklandJSON,
        'Brent': brentJSON,
        'Brentwood': brentwoodJSON,
        'Bridgend': bridgendJSON,
        'Brighton and Hove': brightonandhoveJSON,
        'Bristol, City of': bristolcityofJSON,
        'Broadland': broadlandJSON,
        'Bromley': bromleyJSON,
        'Bromsgrove': bromsgroveJSON,
        'Broxbourne': broxbourneJSON,
        'Broxtowe': broxtoweJSON,
        'Buckinghamshire': buckinghamshireJSON,
        'Burnley': burnleyJSON,
        'Bury': buryJSON,
        'Caerphilly': caerphillyJSON,
        'Calderdale': calderdaleJSON,
        'Cambridge': cambridgeJSON,
        'Camden': camdenJSON,
        'Cannock Chase': cannockchaseJSON,
        'Canterbury': canterburyJSON,
        'Cardiff': cardiffJSON,
        'Carlisle': carlisleJSON,
        'Carmarthenshire': carmarthenshireJSON,
        'Castle Point': castlepointJSON,
        'Causeway Coast and Glens': causewaycoastandglensJSON,
        'Central Bedfordshire': centralbedfordshireJSON,
        'Ceredigion': ceredigionJSON,
        'Charnwood': charnwoodJSON,
        'Chelmsford': chelmsfordJSON,
        'Cheltenham': cheltenhamJSON,
        'Cherwell': cherwellJSON,
        'Cheshire East': cheshireeastJSON,
        'Cheshire West and Chester': cheshirewestandchesterJSON,
        'Chesterfield': chesterfieldJSON,
        'Chichester': chichesterJSON,
        'Chorley': chorleyJSON,
        'City of Edinburgh': cityofedinburghJSON,
        'City of London': cityoflondonJSON,
        'Clackmannanshire': clackmannanshireJSON,
        'Colchester': colchesterJSON,
        'Conwy': conwyJSON,
        'Copeland': copelandJSON,
        'Cornwall': cornwallJSON,
        'Cotswold': cotswoldJSON,
        'County Durham': countydurhamJSON,
        'Coventry': coventryJSON,
        'Craven': cravenJSON,
        'Crawley': crawleyJSON,
        'Croydon': croydonJSON,
        'Dacorum': dacorumJSON,
        'Darlington': darlingtonJSON,
        'Dartford': dartfordJSON,
        'Denbighshire': denbighshireJSON,
        'Derby': derbyJSON,
        'Derbyshire Dales': derbyshiredalesJSON,
        'Derry City and Strabane': derrycityandstrabaneJSON,
        'Doncaster': doncasterJSON,
        'Dorset': dorsetJSON,
        'Dover': doverJSON,
        'Dudley': dudleyJSON,
        'Dumfries and Galloway': dumfriesandgallowayJSON,
        'Dundee City': dundeecityJSON,
        'Ealing': ealingJSON,
        'East Ayrshire': eastayrshireJSON,
        'East Cambridgeshire': eastcambridgeshireJSON,
        'East Devon': eastdevonJSON,
        'East Dunbartonshire': eastdunbartonshireJSON,
        'East Hampshire': easthampshireJSON,
        'East Hertfordshire': easthertfordshireJSON,
        'East Lindsey': eastlindseyJSON,
        'East Lothian': eastlothianJSON,
        'East Renfrewshire': eastrenfrewshireJSON,
        'East Riding of Yorkshire': eastridingofyorkshireJSON,
        'East Staffordshire': eaststaffordshireJSON,
        'East Suffolk': eastsuffolkJSON,
        'Eastbourne': eastbourneJSON,
        'Eastleigh': eastleighJSON,
        'Eden': edenJSON,
        'Elmbridge': elmbridgeJSON,
        'Enfield': enfieldJSON,
        'Epping Forest': eppingforestJSON,
        'Epsom and Ewell': epsomandewellJSON,
        'Erewash': erewashJSON,
        'Exeter': exeterJSON,
        'Falkirk': falkirkJSON,
        'Fareham': farehamJSON,
        'Fenland': fenlandJSON,
        'Fermanagh and Omagh': fermanaghandomaghJSON,
        'Fife': fifeJSON,
        'Flintshire': flintshireJSON,
        'Folkestone and Hythe': folkestoneandhytheJSON,
        'Forest of Dean': forestofdeanJSON,
        'Fylde': fyldeJSON,
        'Gateshead': gatesheadJSON,
        'Gedling': gedlingJSON,
        'Glasgow City': glasgowcityJSON,
        'Gloucester': gloucesterJSON,
        'Gosport': gosportJSON,
        'Gravesham': graveshamJSON,
        'Great Yarmouth': greatyarmouthJSON,
        'Greenwich': greenwichJSON,
        'Guildford': guildfordJSON,
        'Gwynedd': gwyneddJSON,
        'Hackney': hackneyJSON,
        'Halton': haltonJSON,
        'Hambleton': hambletonJSON,
        'Hammersmith and Fulham': hammersmithandfulhamJSON,
        'Harborough': harboroughJSON,
        'Haringey': haringeyJSON,
        'Harlow': harlowJSON,
        'Harrogate': harrogateJSON,
        'Harrow': harrowJSON,
        'Hart': hartJSON,
        'Hartlepool': hartlepoolJSON,
        'Hastings': hastingsJSON,
        'Havant': havantJSON,
        'Havering': haveringJSON,
        'Herefordshire, County of': herefordshirecountyofJSON,
        'Hertsmere': hertsmereJSON,
        'High Peak': highpeakJSON,
        'Highland': highlandJSON,
        'Hillingdon': hillingdonJSON,
        'Hinckley and Bosworth': hinckleyandbosworthJSON,
        'Horsham': horshamJSON,
        'Hounslow': hounslowJSON,
        'Huntingdonshire': huntingdonshireJSON,
        'Hyndburn': hyndburnJSON,
        'Inverclyde': inverclydeJSON,
        'Ipswich': ipswichJSON,
        'Isle of Anglesey': isleofangleseyJSON,
        'Isle of Wight': isleofwightJSON,
        'Isles of Scilly': islesofscillyJSON,
        'Islington': islingtonJSON,
        'Kensington and Chelsea': kensingtonandchelseaJSON,
        'King\'s Lynn and West Norfolk': kingslynnandwestnorfolkJSON,
        'Kingston upon Hull, City of': kingstonuponhullcityofJSON,
        'Kingston upon Thames': kingstonuponthamesJSON,
        'Kirklees': kirkleesJSON,
        'Knowsley': knowsleyJSON,
        'Lambeth': lambethJSON,
        'Lancaster': lancasterJSON,
        'Leeds': leedsJSON,
        'Leicester': leicesterJSON,
        'Lewes': lewesJSON,
        'Lewisham': lewishamJSON,
        'Lichfield': lichfieldJSON,
        'Lincoln': lincolnJSON,
        'Lisburn and Castlereagh': lisburnandcastlereaghJSON,
        'Liverpool': liverpoolJSON,
        'Luton': lutonJSON,
        'Maidstone': maidstoneJSON,
        'Maldon': maldonJSON,
        'Malvern Hills': malvernhillsJSON,
        'Manchester': manchesterJSON,
        'Mansfield': mansfieldJSON,
        'Medway': medwayJSON,
        'Melton': meltonJSON,
        'Mendip': mendipJSON,
        'Merthyr Tydfil': merthyrtydfilJSON,
        'Merton': mertonJSON,
        'Mid Devon': middevonJSON,
        'Mid Suffolk': midsuffolkJSON,
        'Mid Sussex': midsussexJSON,
        'Mid Ulster': midulsterJSON,
        'Mid and East Antrim': midandeastantrimJSON,
        'Middlesbrough': middlesbroughJSON,
        'Midlothian': midlothianJSON,
        'Milton Keynes': miltonkeynesJSON,
        'Mole Valley': molevalleyJSON,
        'Monmouthshire': monmouthshireJSON,
        'Moray': morayJSON,
        'Na h-Eileanan Siar': nah_eileanansiarJSON,
        'Neath Port Talbot': neathporttalbotJSON,
        'New Forest': newforestJSON,
        'Newark and Sherwood': newarkandsherwoodJSON,
        'Newcastle upon Tyne': newcastleupontyneJSON,
        'Newcastle-under-Lyme': newcastle_under_lymeJSON,
        'Newham': newhamJSON,
        'Newport': newportJSON,
        'Newry, Mourne and Down': newrymourneanddownJSON,
        'North Ayrshire': northayrshireJSON,
        'North Devon': northdevonJSON,
        'North East Derbyshire': northeastderbyshireJSON,
        'North East Lincolnshire': northeastlincolnshireJSON,
        'North Hertfordshire': northhertfordshireJSON,
        'North Kesteven': northkestevenJSON,
        'North Lanarkshire': northlanarkshireJSON,
        'North Lincolnshire': northlincolnshireJSON,
        'North Norfolk': northnorfolkJSON,
        'North Northamptonshire': northnorthamptonshireJSON,
        'North Somerset': northsomersetJSON,
        'North Tyneside': northtynesideJSON,
        'North Warwickshire': northwarwickshireJSON,
        'North West Leicestershire': northwestleicestershireJSON,
        'Northumberland': northumberlandJSON,
        'Norwich': norwichJSON,
        'Nottingham': nottinghamJSON,
        'Nuneaton and Bedworth': nuneatonandbedworthJSON,
        'Oadby and Wigston': oadbyandwigstonJSON,
        'Oldham': oldhamJSON,
        'Orkney Islands': orkneyislandsJSON,
        'Oxford': oxfordJSON,
        'Pembrokeshire': pembrokeshireJSON,
        'Pendle': pendleJSON,
        'Perth and Kinross': perthandkinrossJSON,
        'Peterborough': peterboroughJSON,
        'Plymouth': plymouthJSON,
        'Portsmouth': portsmouthJSON,
        'Powys': powysJSON,
        'Preston': prestonJSON,
        'Reading': readingJSON,
        'Redbridge': redbridgeJSON,
        'Redcar and Cleveland': redcarandclevelandJSON,
        'Redditch': redditchJSON,
        'Reigate and Banstead': reigateandbansteadJSON,
        'Renfrewshire': renfrewshireJSON,
        'Rhondda Cynon Taf': rhonddacynontafJSON,
        'Ribble Valley': ribblevalleyJSON,
        'Richmond upon Thames': richmonduponthamesJSON,
        'Richmondshire': richmondshireJSON,
        'Rochdale': rochdaleJSON,
        'Rochford': rochfordJSON,
        'Rossendale': rossendaleJSON,
        'Rother': rotherJSON,
        'Rotherham': rotherhamJSON,
        'Rugby': rugbyJSON,
        'Runnymede': runnymedeJSON,
        'Rushcliffe': rushcliffeJSON,
        'Rushmoor': rushmoorJSON,
        'Rutland': rutlandJSON,
        'Ryedale': ryedaleJSON,
        'Salford': salfordJSON,
        'Sandwell': sandwellJSON,
        'Scarborough': scarboroughJSON,
        'Scottish Borders': scottishbordersJSON,
        'Sedgemoor': sedgemoorJSON,
        'Sefton': seftonJSON,
        'Selby': selbyJSON,
        'Sevenoaks': sevenoaksJSON,
        'Sheffield': sheffieldJSON,
        'Shetland Islands': shetlandislandsJSON,
        'Shropshire': shropshireJSON,
        'Slough': sloughJSON,
        'Solihull': solihullJSON,
        'Somerset West and Taunton': somersetwestandtauntonJSON,
        'South Ayrshire': southayrshireJSON,
        'South Cambridgeshire': southcambridgeshireJSON,
        'South Derbyshire': southderbyshireJSON,
        'South Gloucestershire': southgloucestershireJSON,
        'South Hams': southhamsJSON,
        'South Holland': southhollandJSON,
        'South Kesteven': southkestevenJSON,
        'South Lakeland': southlakelandJSON,
        'South Lanarkshire': southlanarkshireJSON,
        'South Norfolk': southnorfolkJSON,
        'South Oxfordshire': southoxfordshireJSON,
        'South Ribble': southribbleJSON,
        'South Somerset': southsomersetJSON,
        'South Staffordshire': southstaffordshireJSON,
        'South Tyneside': southtynesideJSON,
        'Southampton': southamptonJSON,
        'Southend-on-Sea': southendonseaJSON,
        'Southwark': southwarkJSON,
        'Spelthorne': spelthorneJSON,
        'St Albans': stalbansJSON,
        'St. Helens': sthelensJSON,
        'Stafford': staffordJSON,
        'Staffordshire Moorlands': staffordshiremoorlandsJSON,
        'Stevenage': stevenageJSON,
        'Stirling': stirlingJSON,
        'Stockport': stockportJSON,
        'Stockton-on-Tees': stocktononteesJSON,
        'Stoke-on-Trent': stokeontrentJSON,
        'Stratford-on-Avon': stratfordonavonJSON,
        'Stroud': stroudJSON,
        'Sunderland': sunderlandJSON,
        'Surrey Heath': surreyheathJSON,
        'Sutton': suttonJSON,
        'Swale': swaleJSON,
        'Swansea': swanseaJSON,
        'Swindon': swindonJSON,
        'Tameside': tamesideJSON,
        'Tamworth': tamworthJSON,
        'Tandridge': tandridgeJSON,
        'Teignbridge': teignbridgeJSON,
        'Telford and Wrekin': telfordandwrekinJSON,
        'Tendring': tendringJSON,
        'Test Valley': testvalleyJSON,
        'Tewkesbury': tewkesburyJSON,
        'Thanet': thanetJSON,
        'Three Rivers': threeriversJSON,
        'Thurrock': thurrockJSON,
        'Tonbridge and Malling': tonbridgeandmallingJSON,
        'Torbay': torbayJSON,
        'Torfaen': torfaenJSON,
        'Torridge': torridgeJSON,
        'Tower Hamlets': towerhamletsJSON,
        'Trafford': traffordJSON,
        'Tunbridge Wells': tunbridgewellsJSON,
        'Uttlesford': uttlesfordJSON,
        'Vale of Glamorgan': valeofglamorganJSON,
        'Vale of White Horse': valeofwhitehorseJSON,
        'Wakefield': wakefieldJSON,
        'Walsall': walsallJSON,
        'Waltham Forest': walthamforestJSON,
        'Wandsworth': wandsworthJSON,
        'Warrington': warringtonJSON,
        'Warwick': warwickJSON,
        'Watford': watfordJSON,
        'Waverley': waverleyJSON,
        'Wealden': wealdenJSON,
        'Welwyn Hatfield': welwynhatfieldJSON,
        'West Berkshire': westberkshireJSON,
        'West Devon': westdevonJSON,
        'West Dunbartonshire': westdunbartonshireJSON,
        'West Lancashire': westlancashireJSON,
        'West Lindsey': westlindseyJSON,
        'West Lothian': westlothianJSON,
        'West Northamptonshire': westnorthamptonshireJSON,
        'West Oxfordshire': westoxfordshireJSON,
        'West Suffolk': westsuffolkJSON,
        'Westminster': westminsterJSON,
        'Wigan': wiganJSON,
        'Wiltshire': wiltshireJSON,
        'Winchester': winchesterJSON,
        'Windsor and Maidenhead': windsorandmaidenheadJSON,
        'Wirral': wirralJSON,
        'Woking': wokingJSON,
        'Wokingham': wokinghamJSON,
        'Wolverhampton': wolverhamptonJSON,
        'Worcester': worcesterJSON,
        'Worthing': worthingJSON,
        'Wrexham': wrexhamJSON,
        'Wychavon': wychavonJSON,
        'Wyre Forest': wyreforestJSON,
        'Wyre': wyreJSON,
        'York': yorkJSON
    };

    // Function to fetch external data asynchronously
    async function fetchExternalData(filename) {
        try {
            const response = await fetch(`data/queries/${filename}.json`); 
            const data = await response.json();
            return data;
        } catch (error) {
            console.error(`Error fetching external data for ${filename}:`, error);
            return null;
        }
    }

    // Function to create polygons and bind popups dynamically
    async function createPolygonsAndPopups(polygonData, filename, externalData) {
        const polygonLayerGroup = L.layerGroup(); // Create a layer group for polygons

        if (!externalData) {
            console.error('External data not available. Exiting function.');
            return polygonLayerGroup; // Return an empty layer group
        }

        const geoJSONPromises = Object.entries(polygonData).map(async ([districtName, geoJSON]) => {
            if (geoJSON.features && geoJSON.features.length > 0 &&
                geoJSON.features[0].geometry &&
                (geoJSON.features[0].geometry.type === "MultiPolygon" || geoJSON.features[0].geometry.type === "Polygon")) {

                const districtData = externalData.find(item => item.District === districtName);
                const orderQuantity = districtData ? districtData["Number of products"] : 0;
                const popupContent = `District: ${districtName}<br>Order Quantity: ${orderQuantity}`;

                const popupOptions = { autoPan: false }; // You can customize popup options

                const polygon = L.geoJSON(geoJSON, {
                    onEachFeature: function (feature, layer) {
                        // Bind popup
                        layer.bindPopup(popupContent, popupOptions);
                    }
                });

                // Add polygon to the layer group
                polygonLayerGroup.addLayer(polygon);
            }
        });

        // Wait for all GeoJSON promises to resolve
        await Promise.all(geoJSONPromises);

        return polygonLayerGroup;
    }


    // Function to create polygons and bind popups dynamically
    async function fetchDataAndAddPolygons() {
        // Run function for each query defined in run_queries.js
        const queries = ['total_products', 'total_products', '2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023'];

        // Fetch external data for all queries in parallel
        const externalDataPromises = queries.map(query => fetchExternalData(query));
        const externalDataResults = await Promise.all(externalDataPromises);

        console.log("All data loaded");

        // Create polygons for total_products.json
        const totalOrderPolygons = await createPolygonsAndPopups(polygonData, 'total_products', externalDataResults[0]);

        // Add totalOrderPolygons to the map
        totalOrderPolygons.addTo(map);

        // Create an object to store overlay maps
        const overlayMaps = {};

        // Update popups for each subsequent year
        queries.slice(1).forEach((query, index) => {
            const externalData = externalDataResults[index + 1];

            // Update popups for each layer
            totalOrderPolygons.eachLayer(layer => {
                const districtName = layer.feature && layer.feature.properties && layer.feature.properties.District;
                
                if (districtName) {
                    const districtData = externalData.find(item => item.District === districtName);
                    const orderQuantity = districtData ? districtData["Number of products"] : 0;
                    const popupContent = `District: ${districtName}<br>Order Quantity: ${orderQuantity}`;

                    layer.setPopupContent(popupContent);
                }
            });

            // Clone totalOrderPolygons for each year and add to overlayMaps
            overlayMaps[query] = L.layerGroup(totalOrderPolygons.getLayers());
        });

        // Layer control
        const baseMaps = {
            "OpenStreetMap": osm,
        };

        // Add overlay maps to the map
        Object.values(overlayMaps).forEach(layer => {
            layer.addTo(map);
        });

        // Create layer control
        const layerControl = L.control.layers(baseMaps, overlayMaps, { collapsed: false, autoZIndex: false }).addTo(map);
    }

    // Call the function
    fetchDataAndAddPolygons();



</script>